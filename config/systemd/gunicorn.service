# This is a systemd unit that defines the Gunicorn service.
# https://docs.gunicorn.org/en/stable/deploy.html#systemd
# https://www.freedesktop.org/software/systemd/man/latest/systemd.service.html

[Unit]
Description=gunicorn service
Requires=gunicorn.socket
After=network.target

[Service]
# gunicorn can let systemd know when it is ready
Type=notify
NotifyAccess=main
# the specific user that our service will run as
User=gunicorn
Group=gunicorn
# this user can be transiently created by systemd
DynamicUser=true
RuntimeDirectory=gunicorn
WorkingDirectory=/opt/sort
# Collect static files on launch
# See: https://docs.djangoproject.com/en/5.1/howto/static-files/#deployment
ExecStartPre=/opt/sort/venv/bin/python manage.py collectstatic --no-input
ExecStart=/opt/sort/venv/bin/gunicorn SORT.wsgi
ExecReload=/bin/kill -s HUP $MAINPID
KillMode=mixed
TimeoutStopSec=5
PrivateTmp=true
# if your app does not need administrative capabilities, let systemd know
ProtectSystem=strict
Delegate=yes

[Install]
WantedBy=multi-user.target
